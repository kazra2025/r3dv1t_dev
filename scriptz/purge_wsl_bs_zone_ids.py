import os
from pathlib import Path
import subprocess as sp

# ------------------------------------------------------------------------------------------------------------------------------
# ------------------------------------------------------------------------------------------------------------------------------
_REPO_ROOT_PATH = Path(sp.check_output(["git", "rev-parse", "--show-toplevel"], text=True).strip()).resolve()


# ------------------------------------------------------------------------------------------------------------------------------
# ------------------------------------------------------------------------------------------------------------------------------
def purge_wsl_bs_zone_ids():

    zone_files = [f for f in Path(_REPO_ROOT_PATH).rglob('*') if "Zone.Identifier" in f.name]
    for zf in zone_files:
        if zf.exists():
            print(zf)
            zf.unlink()

    print(f"Purged {len(zone_files)} Zone.Identifier files from {_REPO_ROOT_PATH}.")


# ------------------------------------------------------------------------------------------------------------------------------
# ------------------------------------------------------------------------------------------------------------------------------
if '__main__' == __name__:
    purge_wsl_bs_zone_ids()
